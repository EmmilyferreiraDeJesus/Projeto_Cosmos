<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="../js/sessao.js"></script>

    <!--Link CSS-->
    <link rel="stylesheet" href="../css/estilo.css">
    <!--Link Google Icons-->
    <link rel="shortcut icon" href="../assets/LOGOTIPO.png" type="image/x-icon">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <title>Cosmos | Os melhores livros de astronomia para iniciantes</title>
</head>

<!-- validarSessao(), -->

<body onload="atualizarFeed()">

    <!--Container com a imagem principal e header-->
    <div class="container-principal-blog">

        <div class="header">
            <div class="container">

                <p class="email">
                    <span class="material-symbols-outlined">mail</span>
                    <a href="#">emmily.ferreira@spetch.school</a>
                </p>

                <a><img class="logo-blog" src="../assets/LOGOTIPO.png" alt="Logo Cosmos"></a>

                <div class="navbar">
                    <ul>
                        <li><a href="blog.html">Blog</a></li>
                        <li><a href="#" onclick="limparSessao()">Sair</a></li>
                    </ul>
                </div>
            </div>

            <div class="conteudo-principal-blog">

                <h1>Blog</h1>

            </div>

        </div>

    </div>


    <!--Container da postagem-->
    <div class="container-postagem">

        <div class="postagem">

            <h1>Os melhores livros de astronomia para iniciantes</h1>
            <p class="data-post-p">
                <span class="material-symbols-outlined icon">calendar_clock</span>
                Janeiro 27, 2023 ás 17:56
            </p>

            <p>Procurando uma leitura que expanda o seu conhecimento astronômico? Aqui está uma seleção dos melhores
                livros de astronomia para leigos.</p>

            <img src="../assets/observacao.jpg">

            <p>A astronomia é um assunto que cativa a humanidade há milênios. Entretanto, diante da vastidão do espaço e
                do tempo, pode ser um desafio compreender o que se passa no céu acima de nossas cabeças.<br> <br>

                Felizmente, existem muitas publicações sobre astronomia em que podemos nos tornar um pouco mais
                informados sobre o nosso gigantesco Universo.<br> <br>

                Se você é um entusiasta ou iniciante no assunto, aqui estão alguns dos principais livros de astronomia
                para iniciantes.<br> <br>

                Confira!<br> <br>
            </p>

            <h3>Astronomia para Leigos</h3>

            <p>
                Autor: Stephen P. Maran <br> <br>
                Editora: Alta Books <br> <br>
                Número de páginas: 336 páginas <br> <br>

                Como o nome já diz, o livro busca apresentar a astronomia para iniciantes, por meio de uma linguagem
                fácil, didática e acessível. <br> <br>

                Ele faz parte da ampla e famosa “Coleção para Leigos”, que publica livros introdutórios sobre os mais
                variados temas, neste caso, exclusivamente sobre astronomia. <br> <br>

                Com este livro, o leitor aprenderá o necessário para tornar a astronomia um hobby. <br> <br>

                Por exemplo, ele ensina a identificar as constelações no céu, apresenta a diferença entre quasares e
                buracos negros, além de abordar fatos estranhos sobre o espaço. <br> <br>
            </p>

            <h3>Aprendendo a ler o Céu: Pequeno Guia Prático Para Astronomia Observacional</h3>

            <p> Autor: Rodolfo Langhi <br> <br>
                Editora: Livraria de Física <br> <br>
                Número de páginas: 144 páginas <br> <br>

                Este livro é indicado para quem tem interesse em dar os primeiros passos na observação do céu noturno.
                <br> <br>

                O autor do livro, Rodolfo Langhi, é professor da Universidade Estadual Paulista em Bauru e está à frente
                do Observatório da Unesp. Regularmente, Rodolfo promove cursos de observação do céu e condensou neste
                guia as principais dicas de como observar as estrelas, os planetas e a Lua, bem como fenômenos
                astronômicos, como eclipses, por exemplo. <br> <br>

                O livro conta com tabelas para consulta, mapas do céu mensais e, até mesmo, ensina como construir um
                modelo da esfera celeste e um relógio estelar. <br> <br>
            </p>

            <h3>50 Coisas Para Ver com um Pequeno Telescópio</h3>

            <p> Autor: John A Read <br> <br>
                Editora: Createspace Independent Publishing Platform <br> <br>
                Número de páginas: 74 páginas <br> <br>

                Versão brasileira do americano “50 Things to See with a Small Telescope”, o livro lista os principais
                objetos do céu noturno para observação por meio de telescópios de pequeno porte e vistos a partir do
                hemisfério sul. <br> <br>

                O livro é ideal para quem conhece um pouco de astronomia observacional e que já tem ou está pensando em
                investir na compra de um telescópio. <br> <br>

                Além de apresentar como localizar os objetos, o livro também mostra como os objetos são visíveis com um
                instrumento astronômico. <br> <br>
            </p>

            <h3>Astrofotografia Prática</h3>

            <p> Finalmente, se você pretende começar a se aventurar na fotografia do céu noturno, o livro do
                astrofotógrafo Rodrigo Andolfato é bem completo. <br> <br>

                O livro aborda as principais técnicas para atingir os melhores resultados fotográficos, abordando desde
                a escolha do local para praticar astrofotografia, passando pela compra dos equipamentos, o processamento
                das fotos e até onde publicar a imagem. <br> <br>

                Rodrigo também explica os diferentes tipos de astrofotografia – entre elas a de paisagem, lunar, solar,
                planetária, cometária, de céu profundo e até científica. <br> <br>
            </p>


            <div class="curtida-postagem">
                <p class="likes">
                    <i id="botaoCurtir" onclick="curtir()" class="fa-solid fa-thumbs-up fa-2x"></i>
                    <span id="numero_curtidas"></span>
                </p>
            </div>

            <div class="comentarios-postagem">

                <h3>Comentarios</h3>

                <div id="comentario">
                    <div id="feed_container" class="feed-container"></div>
                </div>

                <form id="form_postagem" method="post" onsubmit="return publicar()">

                    <h3>Deixe um comentário</h3>

                    <textarea id="textarea_descricao" name="descricao" maxlength="300"></textarea>

                    <button>Enviar</button>
                    <div id="erro_comentario"></div>

                </form>

            </div>

        </div>

    </div>

    <!--Rodapé-->
    <div class="rodape">
        <a><img src="../assets/LOGOTIPO.png" alt="Logo Cosmos"></a>
        <div class="rodape-links">
            <div class="links">
                <a href="#"><img src="../assets/facebook.png" alt="facebook"></a>
                <a href="#"><img src="../assets/instagram.png" alt="instagram"></a>
                <a href="#"><img src="../assets/twitter.png" alt="twiter"></a>
                <p>
                    <a href="blog.html">Blog</a>
                </p>
                <p>© 2023 Cosmos. All Rights Reserved</p>
            </div>
        </div>
    </div>




    <script src="https://kit.fontawesome.com/d4c069e090.js" crossorigin="anonymous"></script>

</body>

</html>
<script>

    var idPost = 1;
    var idUsuario = sessionStorage.ID_USUARIO;


    function limparFormulario() {
        document.getElementById("form_postagem").reset();
    }

    function verificarCurtida(idUsuario, idPost) {
        fetch(`/comentarios/verificarCurtida/${idUsuario}/${idPost}`)

        console.log('Verificar Curtidas' + idPost)

            .then(function (resposta) {
                if (resposta.ok) {
                    return resposta.json();

                } else {
                    throw new Error('Erro ao verificar curtida');
                }
            })
            .then(function (resposta) {
                console.log('Resultado da curtida', resposta.curtiu);
                sessionStorage.setItem(`CURTIDA_POST${idPost}`, resposta.curtiu);
            })
            .catch(function (erro) {
                console.error('Erro:', erro);
            });
    }


    function curtir() {
        var jaCurtiu = sessionStorage.getItem(`curtida_${idPost}`);

        if (jaCurtiu) {
            alert("Você já curtiu esta postagem!");
        } else {
            // Antes de enviar a solicitação, verifica se o usuário já curtiu
            fetch(`/comentarios/verificarCurtida/${idUsuario}/${idPost}`)
                .then(function (resposta) {
                    if (resposta.ok) {
                        return resposta.json();
                    } else {
                        throw new Error('Erro ao verificar curtida');
                    }
                })
                .then(function (resposta) {
                    if (!resposta.curtiu) {
                        // Se o usuário ainda não curtiu, então envie a solicitação de curtir
                        return fetch(`/comentarios/curtir/${idUsuario}/${idPost}`, {
                            method: "post",
                            headers: {
                                "Content-Type": "application/json"
                            },
                        });
                    } else {
                        alert("Você já curtiu este post!");
                        return Promise.reject('Usuário já curtiu');
                    }
                })
                .then(function (resposta) {
                    if (resposta.ok) {
                        alert("Post curtido");
                        window.location = "/dashboard/post1.html";
                        console.log("idCurtida realizada com sucesso");

                        sessionStorage.setItem(`CURTIDA_POST${idPost}`, true);

                        // Chama a função verificarCurtida para atualizar o estado no sessionStorage
                        verificarCurtida(idUsuario, idPost);

                        // finalizarAguardar();
                    } else if (resposta.status == 404) {
                        window.alert("Deu 404!");
                    } else {
                        throw new Error("Houve um erro ao tentar realizar a curtida! Código da resposta: " + resposta.status);
                    }
                })
                .catch(function (erro) {
                    console.log(`#ERRO: ${erro}`);
                    // finalizarAguardar();
                });

            return false;
        }
    }

    function publicar() {

        var corpo = {
            descricao: form_postagem.descricao.value
        }

        if (!corpo.descricao.trim()) { // Remove espaços em branco no início e no fim

            // Se a descrição estiver vazia ou nula, exibir mensagem de erro e não enviar o formulário
            erro_comentario.innerHTML = "O comentário não pode ser vazio";
            return false;
        }

        fetch(`/comentarios/publicar/${idUsuario}/${idPost}`, {
            method: "post",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(corpo)
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                window.location = "/dashboard/post1.html";
                console.log("idPost em publicar:", idPost);

                limparFormulario();
                // finalizarAguardar();
            } else if (resposta.status == 404) {
                window.alert("Deu 404!");
            } else {
                throw ("Houve um erro ao tentar realizar o comentario! Código da resposta: " + resposta.status);
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
            // finalizarAguardar();
        });

        return false;

    }

    function atualizarFeed() {
        fetch(`/comentarios/listar/${idPost}`).then(function (resposta) {

            console.log('Atualizar' + idPost);

            if (resposta.ok) {
                if (resposta.status == 204) {
                    var feed = document.getElementById("feed_container");
                    var mensagem = document.createElement("span");
                    mensagem.innerHTML = "Nenhum comentario foi feito";
                    mensagem.classList.add("mensagem");
                    feed.appendChild(mensagem);
                    throw "Nenhum resultado encontrado!!";
                }

                resposta.json().then(function (resposta) {
                    console.log("Dados recebidos: ", JSON.stringify(resposta));

                    var feed = document.getElementById("feed_container");
                    feed.innerHTML = "";
                    for (let i = 0; i < resposta.length; i++) {
                        var publicacao = resposta[i];

                        // criando e manipulando elementos do HTML via JavaScript
                        var divPublicacao = document.createElement("div");
                        var spanNome = document.createElement("span");
                        var divDescricao = document.createElement("div");

                        spanNome.innerHTML = `<img width="60px" heigth="60px" style="border-radius: 50%;" src="${publicacao.imagem}"> ${publicacao.nome}`;
                        divDescricao.innerHTML = publicacao.descricao;

                        divPublicacao.className = "publicacao";
                        spanNome.className = "publicacao-nome";
                        divDescricao.className = "publicacao-descricao"

                        divPublicacao.appendChild(spanNome);
                        divPublicacao.appendChild(divDescricao);
                        feed.appendChild(divPublicacao);
                    }

                    // finalizarAguardar();
                });
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);
            // finalizarAguardar();
        });

        // Incluir contagem de curtidas
        fetch(`/comentarios/contarCurtidas/${idPost}`)
            .then(function (resposta) {
                if (resposta.ok) {
                    return resposta.json();
                } else {
                    throw new Error('Erro ao contar curtidas');
                }
            })
            .then(function (resposta) {
                // Exibir a contagem de curtidas na interface do usuário
                var numeroCurtidas = resposta.numeroCurtidas;
                var numeroCurtidasElement = document.getElementById("numero_curtidas");
                numeroCurtidasElement.innerHTML = numeroCurtidas;
            })
            .catch(function (erro) {
                console.error('Erro:', erro);
            });

    }


</script>